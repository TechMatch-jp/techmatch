================================================================================
  🚀 TechMatch 完全最適化版 - 起動ガイド
================================================================================

■ この版の特徴
================================================================================

✅ ChatGPTが作った不具合をすべて修正
✅ 管理者ページの承認待ち特許が正しく表示される
✅ 詳細なデバッグログで問題の特定が簡単
✅ Supabaseとの接続が最適化されている
✅ コードが整理され、保守性が向上


■ 初回セットアップ
================================================================================

【ステップ1】 Supabaseでデータベース作成（初回のみ）

1. https://supabase.com/dashboard を開く
2. プロジェクトを選択
3. 左メニュー「SQL Editor」をクリック
4. 「+ New query」をクリック
5. 「supabase-schema.sql」をメモ帳で開く
6. 全てコピー（Ctrl+A → Ctrl+C）
7. SQL Editorに貼り付け（Ctrl+V）
8. 「Run」ボタンをクリック
9. 「Success. No rows returned」と表示されればOK
10. 左メニュー「Table Editor」で4つのテーブルを確認：
    - users
    - patents
    - interests
    - messages


【ステップ2】 パッケージをインストール

コマンドプロンプトで：
```
npm install
```

（少し時間がかかります）


【ステップ3】 サーバーを起動

```
npm start
```

以下のメッセージが表示されます：
```
✅ TechMatch server (Supabase版) started on http://localhost:3000
📊 Database: Supabase PostgreSQL
📝 WordPress: http://techmatch.jp/blog
```


【ステップ4】 ブラウザで確認

http://localhost:3000 を開く


■ 次回以降の起動
================================================================================

データベース作成は初回のみなので、次回からは：

```
npm start
```

だけでOKです。


■ 管理者ページの使い方
================================================================================

【管理者アカウントの作成】

1. http://localhost:3000/auth.html を開く
2. 「新規登録」をクリック
3. 以下の情報を入力：
   - メールアドレス: admin@techmatch.jp
   - パスワード: admin123
   - 名前: 管理者
   - アカウントタイプ: 買い手企業
4. 登録後、Supabaseで手動でuser_typeを'admin'に変更

【管理者ページへのアクセス】

http://localhost:3000/admin.html


【デバッグ方法】

1. 管理者ページを開く
2. F12キーを押して開発者ツールを開く
3. 「Console」タブをクリック
4. 以下のログが表示されます：

```
📋 承認待ち特許を読み込み中...
📡 APIレスポンス: 200 OK
✅ 取得した特許数: 2
📊 特許データ: [...]
```

エラーが出る場合は、このログを確認してください。


■ トラブルシューティング
================================================================================

【問題1】 「承認待ち特許の取得に失敗しました」

原因: 
- Supabaseの接続情報が間違っている
- データベーステーブルが作成されていない

解決策:
1. .envファイルを確認
2. ステップ1（データベース作成）を再実行


【問題2】 404エラー（Not Found）

原因:
- 管理者としてログインしていない
- トークンが無効

解決策:
1. http://localhost:3000/auth.html でログイン
2. その後、管理者ページを開く


【問題3】 owner_nameが「不明」と表示される

原因:
- usersテーブルにデータがない
- owner_idとusersのidが一致していない

解決策:
1. Supabase「Table Editor」でusersテーブルを確認
2. 出品者アカウントで特許を登録


【問題4】 「環境変数が設定されていません」

原因:
- .envファイルが存在しない

解決策:
1. ZIPを解凍し直す
2. .envファイルが含まれているか確認


■ 設定済み内容（変更不要）
================================================================================

Supabase URL: https://ytnxnvwnxaaxfvhkrtlt.supabase.co
WordPress: http://techmatch.jp/blog

全て設定済みです。


■ テストデータの登録
================================================================================

【出品者アカウント作成】

1. http://localhost:3000/auth.html
2. 新規登録
3. アカウントタイプ: 特許保有者

【特許を登録】

1. ログイン後、マイページへ
2. 「新しい特許を登録」をクリック
3. 必要事項を入力して登録

【管理者ページで確認】

1. 管理者アカウントでログイン
2. http://localhost:3000/admin.html
3. 「承認待ち特許」に登録した特許が表示される


================================================================================
  追加情報
================================================================================

■ 開発用機能

認証をスキップしたい場合（開発時のみ）：

.envファイルに以下を追加：
```
SKIP_AUTH=true
```

※本番環境では絶対に使わないでください


■ WordPress連携

技術コラムや研究者インタビューはWordPressで管理します。
詳細はREADME.mdを参照してください。


================================================================================
