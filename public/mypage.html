<!DOCTYPE html>
<html lang="ja">
<head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-47LCYNSVRP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-47LCYNSVRP');
</script>


    <meta charset="UTF-8">
    <title>リダイレクト中...</title>
</head>
<body>
    <p>マイページに移動中...</p>
    <script>
        async function redirect() {
            console.log('=== mypage.html リダイレクト開始 ===');
            try {
                console.log('1. /api/user を呼び出し中...');
                const response = await fetch('/api/user');
                console.log('2. レスポンス受信:', response.status, response.ok);
                
                if (response.ok) {
                    const user = await response.json();
                    console.log('3. ユーザー情報取得:', user);
                    console.log('4. userType:', user.userType);
                    
                    if (user.userType === 'admin') {
                        console.log('5. 管理者ページへ移動');
                        window.location.href = 'admin.html';
                    } else if (user.userType === 'buyer') {
                        console.log('5. 買い手ページへ移動');
                        window.location.href = 'mypage-buyer.html';
                    } else {
                        console.log('5. 売り手ページへ移動');
                        window.location.href = 'mypage-seller.html';
                    }
                } else {
                    console.error('認証失敗: ログインページへ');
                    window.location.href = 'auth.html';
                }
            } catch (error) {
                console.error('エラー発生:', error);
                window.location.href = 'auth.html';
            }
        }
        redirect();
    </script>
</body>
</html>
